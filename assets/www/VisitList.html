<!DOCTYPE html>
<html>
  <head>
    <title>Visit List</title>
	<link href="fonts/material-icons/iconfont/material-icons.css" rel="stylesheet">

    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.css" media="screen,projection" />
    <link type="text/css" rel="stylesheet" href="css/style.css" />

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
	<script type="text/javascript" charset="utf-8" src="js/camera.js"></script>
	 
	<script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
	<script type="text/javascript" src="js/materialize.js"></script>
 <script src="js/CallNumber.js"></script>	  

    <script src="Login.js"></script>
    <script src="Logout.js"></script>
    <style>
	 
    .table-striped>tbody>tr:nth-of-type(odd) {
    background-color: #E0E0E0;
}
	.inputfile-4 + label figure, .capture_cam{
		width: 90px;
		height: 90px;
		border-radius: 50%;
		background-color: #ef3864;
		display: block;
		padding: 28px;
		margin: 0 auto 10px;
		color:#fff;
		box-shadow: 0 10px 20px #999, inset 0px 1px 5px #676767, 0 -10px 20px #f3f3f3;
	}
	.inputfile {
		width: 0.1px;
		height: 0.1px;
		opacity: 0;
		overflow: hidden;
		position: absolute;
		z-index: -1;
	}
	.up_file, .up_cam{
	  width: 25%;
      float: left;
	      margin-left: 15%;
	}
	.up_file{
	  text-align: center;
	}
	.nav-extended{
	      margin-bottom: 20px;
	} 
	tbody td, thead th {
		width: 30%;	
	}
	tbody {
			
		overflow-y: auto;    /* Trigger vertical scroll    */
		overflow-x: hidden;  /* Hide the horizontal scroll */
		
		}
	#myrole td,th{
	 text-align:center;
	}	
	#myrole i{
	 float:left;
	}
    </style>
  </head>
  <body>
  
    <ul id="slide-out" class="side-nav">
        <li>
            <div class="user-view">
                <div class="background">

                </div>
                <a href="#!user">
                    <img class="circle" src="images/yuna.jpg">
                </a>
                <a href="#!name">
                    <span id="loginname" class="white-text name">Username</span>
                </a>
                
            </div>
        </li>
       <li >
            <a class="waves-effect" href="Menu.html">
                <i class="material-icons">dashboard</i>Dashboard</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>   
	
		<li>
            <a class="waves-effect" href="DemographicDetails.html">
                <i class="material-icons">group</i>Demographic Details</a>
        </li>
		<li>
            <div class="divider"></div>
        </li>        
		
	 
		<li>
            <a class="waves-effect"  href="DoctorList.html">
                <i class="material-icons">person</i>Consulting Doctors</a>
        </li>
		 <li>
            <div class="divider"></div>
        </li> 
         <li>
            <a class="waves-effect" href="AddDocVisit.html">
                <i class="material-icons">add_box</i>Add Doctor Visit</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
		<li class="activated">
            <a class="waves-effect" href="VisitList.html">
                <i class="material-icons">file_upload</i>Upload Reports</a>
        </li>
		<li>
            <div class="divider"></div>
        </li>
		
		<li>
            <a class="waves-effect" href="Reports.html">
                <i class="material-icons">assignment_turned_in</i>View Reports</a>
        </li>
		<li>
            <div class="divider"></div>
        </li>
		<li>
            <a class="waves-effect" href="InsuranceList.html">
                <i class="material-icons">description</i>Health Insurance</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
		
		<li>
            <a class="waves-effect" href="AddEmergencyNoList.html">
                <i class="material-icons">call</i>Emergency Call</a>
        </li>	
		<li>
            <div class="divider"></div>
        </li>
		
		<li>
            <a class="waves-effect" href="Setting.html">
                <i class="material-icons">settings</i>Setting</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
        <li>
            <a class="waves-effect" onClick="logout();">
                <i class="material-icons">power_settings_new</i>Logout</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
    </ul>

	<div class="mn">
	<nav class="nav-extended">
        <div class="nav-wrapper">
            <a href="#!" class="left brand-logo waves-effect" data-activates="slide-out">
                <i class="material-icons menu">menu</i>
            </a>
            <span style="margin-left: 4rem;font-size: 1.5rem;">Upload Reports</span>
			<a href="Notification.html" class="noti"><i class="material-icons">notifications</i></a>
        </div>
    </nav>
	<div class="row" style="overflow: auto; height: 90vh; margin-bottom:0px;">
	<form id="uploadimage" action="" method="post" enctype="multipart/form-data">
 <div class="col s12 m12">	
		
		<div class="row">		
			<table  name="myrole" class='table-striped' > 
			<thead>
			<tr>
				<th width="50%">Visit Date</th>
				<th width="50%">File Upload</th>
			    				
			</tr>
			</thead>
			<tbody id="myrole" class="well-lg"></tbody>
			</table>
			
		</div></div>
		 
	</form></div>
  <img id="loading_img" style="width: 20%;text-align: center;position: absolute;top: 24%;left: 40%;z-index: 1;display:none;" src="images/uploading.gif" >
  </body>
 
  <script type="text/javascript"> 

 $('.brand-logo').sideNav({
            menuWidth: 300, // Default is 300
            edge: 'left', // Choose the horizontal origin
            closeOnClick: true, // Closes side-nav on <a> clicks, useful for Angular/Meteor
            draggable: true, // Choose whether you can drag to open on touch screens,
            onOpen: function (el) { /* Do Stuff */ }, // A function to be called when sideNav is opened
            onClose: function (el) { /* Do Stuff */ }, // A function to be called when sideNav is closed
        });
		
		
	var loginname = localStorage.getItem('user_name');
	var User_id = localStorage.getItem('u_id');
	//alert(User_id);
	  
    $('#loginname').text(loginname);
	
$("#btnSubmit").click(function () {	
var flg=1;
localStorage.setItem('flgup',flg);
		window.location.href="SaveDoctor.html";
        });
	
$(function(){

try{
             $.ajax({
                               
                                type: "POST",
								url: "https://www.manoramahealthcare.com/health_record_organizer/visit_list.php",
                                data : 'user_id=' + User_id, 
						 success: function (msg)
                            {
								 var parseJson = JSON.parse(msg);    
									 //alert(parseJson[1].role_name)
								//$("#myrole").append('<tr class="collection-item" style="font-weight:bold;text-align:center;"><td>File Name</td> class="collection-item" style="font-weight:bold;text-align:center"><td>Date</td></tr>');
	console.log(parseJson.message);
	
	if(parseJson.result == false){
	
	$("#myrole").append("<span class='norecord'>No Visit Added. <a onclick='addvisit()'>Please Add Visit</a></span>");
	return false;
	
	}else{
	
	for(var i =0;i < parseJson.message.length;i++)
			{ 
				$("#myrole").append('<tr><td width="50%" class="docname" doc-id="'+parseJson.message[i].visit_id+'" >'+ parseJson.message[i].visit_date+'</td><td width="50%" class="callno" data-mob="'+parseJson.message[i].visit_id+'"><span><i class="Small material-icons">file_upload</i>Upload File</span></td></tr>');					
			}
			
			$(".callno").click(function(){
			var mob = $(this).attr('data-mob');			
			localStorage.setItem('visit_id',mob);
			window.location.href="AddReport.html";
			});
			}
			},
 			 
					});
                } catch(e){
                	if(e.status == '0'){
                	//	alert("Request failed");
                	
                		$("#image_id").hide();
                	} else if(e.status == '404') {
                	//	alert("Page not found");
                	
                		$("#image_id").hide();
                	} else if(e.status == '500') {
                	//	alert("Internal Server Error.");
                	
                		$("#image_id").hide();
                	}
                	  else {
                		$("#image_id").hide();
                		return; //skip this error
                	}
                }
 	
});

function addvisit(){

window.location.href="AddDocVisit.html";
}

</script>
</html>