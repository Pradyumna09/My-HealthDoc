<!DOCTYPE html>
<html lang="en"> 
<head>     
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> 
    <link type="text/css" rel="stylesheet" href="css/materialize.css" media="screen,projection" />  
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>	 
    <script type="text/javascript" src="js/materialize.js"></script>
    <style>
         

        .t-scroller {
            width: 100%;
            overflow: auto;
            max-height: 55vh;
        }
        .card{
            margin-bottom: 0px !important;
        }
		input{
		  width:95%!important;
		  padding: 5px!important;
		  border-radius: 2px!important;

		}
		span.screen-title {
			margin-left: 4rem!important;			 
		}
		.picker--opened .picker__frame {
			top: 10px;
		}
		.red-asterisk{
		 color:red;
		}
    </style>
</head> 
<body>  
<ul id="slide-out" class="side-nav">
        <li>
            <div class="user-view">
                <div class="background">

                </div>
                <a href="#!user">
                    <img class="circle" src="images/yuna.jpg">
                </a>
                <a href="#!name">
                    <span id="loginname" class="white-text name">Username</span>
                </a>
                
            </div>
        </li>
        <li >
            <a class="waves-effect" href="Menu.html">
                <i class="material-icons">dashboard</i>Dashboard</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>   
	
		<li>
            <a class="waves-effect" href="DemographicDetails.html">
                <i class="material-icons">group</i>Demographic Details</a>
        </li>
		<li>
            <div class="divider"></div>
        </li>        
		
	 
		<li>
            <a class="waves-effect"  href="DoctorList.html">
                <i class="material-icons">person</i>Consulting Doctors</a>
        </li>
		 <li>
            <div class="divider"></div>
        </li> 
         <li>
            <a class="waves-effect" href="AddDocVisit.html">
                <i class="material-icons">add_box</i>Add Doctor Visit</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
		<li>
            <a class="waves-effect" href="VisitList.html">
                <i class="material-icons">file_upload</i>Upload Reports</a>
        </li>
		<li>
            <div class="divider"></div>
        </li>
		
		<li>
            <a class="waves-effect" href="Reports.html">
                <i class="material-icons">assignment_turned_in</i>View Reports</a>
        </li>
		<li>
            <div class="divider"></div>
        </li>
		<li>
            <a class="waves-effect" href="InsuranceList.html">
                <i class="material-icons">description</i>Health Insurance</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
		
		<li>
            <a class="waves-effect" href="AddEmergencyNoList.html">
                <i class="material-icons">call</i>Emergency Call</a>
        </li>	
		<li>
            <div class="divider"></div>
        </li>
		
		<li class="activated">
            <a class="waves-effect" href="Setting.html">
                <i class="material-icons">settings</i>Setting</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
        <li>
            <a class="waves-effect" onClick="logout();">
                <i class="material-icons">power_settings_new</i>Logout</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
    </ul>

	
	<nav class="nav-extended">
        <div class="nav-wrapper">
            <a href="#!" class="left brand-logo waves-effect" data-activates="slide-out">
                <i class="material-icons menu">menu</i>
            </a>
            <span class="screen-title">Change Password</span>
			<a href="Notification.html" class="noti"><i class="material-icons">notifications</i></a>
        </div>
    </nav>
	
	
    <div class="row" style="overflow: auto; height: 90vh; margin-bottom:0px;">
        <form id="cpass-form" name="cpass-form">                
            <div class="col s12 m12">     
               <div class="input-field col s12 m4">     
                <label for="pass">Old Password <span class='red-asterisk'>*</span></label>              
                <input type="password" id="old_user_password" name="old_user_password" id="pass" >                    
              </div>  
                <div class="input-field col s12 m4">     
                <label for="pass">New Password <span class='red-asterisk'>*</span></label>              
                <input type="password" id="new_user_password" name="new_user_password" id="pass" >                    
              </div>  
              <div class="input-field col s12 m4">     
                <label for="cpass">Confirm Password <span class='red-asterisk'>*</span></label>              
                <input type="password" id="cpass" name="cpass">                    
              </div>			  
              <div class="input-field col s12 m12" style="margin-bottom: 1rem;"> 
			<!--	<a onClick="regUser();" class="col s12 m12 waves-effect waves-light btn btn-block">Submit</a>-->
			
              <a onmousedown="ValidatePass()"  class="col s12 m12 waves-effect waves-light btn modal-trigger btn-block">Change Password</a>
			
			  </div>
            </div>
			</form>
    </div>	

</body>    
   	       
    <script> 
	
	var u_id =  2;//localStorage.getItem('u_id');
	var address = "https://www.manoramahealthcare.com/health_record_organizer/user_change_password.php";
	var loginname = localStorage.getItem('user_name');
    $('#loginname').text(loginname);	
	 $('.brand-logo').sideNav({
            menuWidth: 300, // Default is 300
            edge: 'left', // Choose the horizontal origin
            closeOnClick: true, // Closes side-nav on <a> clicks, useful for Angular/Meteor
            draggable: true, // Choose whether you can drag to open on touch screens,
            onOpen: function (el) { /* Do Stuff */ }, // A function to be called when sideNav is opened
            onClose: function (el) { /* Do Stuff */ }, // A function to be called when sideNav is closed
        });
	
     function ValidatePass(){
	 
	 
	 var opass = $("#old_user_password").val();
	 var npass = $("#new_user_password").val();
	 var cpass = $("#cpass").val();
	 
	 
	  if(opass == ""){
				alert("Please Enter Old Password")
				setTimeout(function(){
                $("#old_user_password").focus();
				},500)
                return false;
			}	
			else if(npass == ""){
				alert("Please Enter New Password")
				setTimeout(function(){
                $("#new_user_password").focus();
				},500)
                return false;
			}
			else if(npass != cpass) {
					   alert("Passwords do not match.");
					   Resetform();
				       return false;
			}
			else {
			
			 $.ajax({
    
			   type : 'POST',
			   url:address,
			   data: { user_id:u_id,
						old_user_password : opass, 
					   new_user_password : npass//put user id here
					},
		 success: function (msg)
                            {
								 var parseJson = JSON.parse(msg);    
								console.log(parseJson.result);
					if(parseJson.result == false){
	
						alert("Old Password Inncorrect");
						Resetform();
						return false;
	
					}
					},
});
}
}
function Resetform(){

			$('#old_user_password').val('');
			$('#new_user_password').val('');
			$('#cpass').val('');
}
    </script>     
</html>