<!DOCTYPE html>
<html>
  <head>
    <title>Doctor List</title>
	<link href="fonts/material-icons/iconfont/material-icons.css" rel="stylesheet">

    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.css" media="screen,projection" />
    <link type="text/css" rel="stylesheet" href="css/style.css" />

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
	<!--<script type="text/javascript" charset="utf-8" src="js/camera.js"></script>	-->
	<script type="text/javascript" src="js/materialize.js"></script>
	<script type="text/javascript" src="js/Login.js"></script>
	<script type="text/javascript" src="js/Logout.js"></script>
	<script src="js/CallNumber.js"></script>	  

    <style>

		td, th {
    padding: 2px 9px;
    border-right: 1px solid #eee !important;
}
	
    </style>
  </head>
  <body onload="onLoad();">
  
  <ul id="slide-out" class="side-nav">
        <li>
            <div class="user-view">
                <div class="background">

                </div>
                <a href="#!user">
                    <img class="circle" src="images/yuna.jpg">
                </a>
                <a href="#!name">
                    <span id="loginname" class="white-text name">Username</span>
                </a>
                
            </div>
        </li>
        <li >
            <a class="waves-effect" href="Menu.html">
                <i class="material-icons">dashboard</i>Dashboard</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>   
	
		<li>
            <a class="waves-effect" href="DemographicDetails.html">
                <i class="material-icons">group</i>Demographic Details</a>
        </li>
		
		 <li>
            <div class="divider"></div>
        </li> 
         <li class="activated">
            <a class="waves-effect"  href="DoctorList.html">
                <i class="material-icons">person</i>Consulting Doctors</a>
        </li>
		 <li>
            <div class="divider"></div>
        </li> 
         <li>
            <a class="waves-effect" href="AddDocVisit.html">
                <i class="material-icons">add_box</i>Add Doctor Visit</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
		<li>
            <a class="waves-effect" href="VisitList.html">
                <i class="material-icons">file_upload</i>Upload Reports</a>
        </li>
		<li>
            <div class="divider"></div>
        </li>
		
		<li>
            <a class="waves-effect" href="Reports.html">
                <i class="material-icons">assignment_turned_in</i>View Reports</a>
        </li>
		<li>
            <div class="divider"></div>
        </li>
		<li>
            <a class="waves-effect" href="InsuranceList.html">
                <i class="material-icons">description</i>Health Insurance</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
		
		<li>
            <a class="waves-effect" href="AddEmergencyNoList.html">
                <i class="material-icons">call</i>Emergency Call</a>
        </li>	
		<li>
            <div class="divider"></div>
        </li>
		<li>
            <a class="waves-effect" onClick="share();">
                <i class="material-icons">share</i>Share App</a>
        </li>
		
		<li>
            <div class="divider"></div>
        </li>
		<li>
            <a class="waves-effect" href="Setting.html">
                <i class="material-icons">settings</i>Setting</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
		<li >
            <a class="waves-effect" href="Feedback.html">
                <i class="material-icons">feedback</i>Feedback</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
        <li>
            <a class="waves-effect" onClick="logout();">
                <i class="material-icons">power_settings_new</i>Logout</a>
        </li>
        <li>
            <div class="divider"></div>
        </li>
    </ul>

	
	<nav class="nav-extended">
        <div class="nav-wrapper">
            <a href="#!" class="left brand-logo waves-effect" data-activates="slide-out">
                <i class="material-icons menu">menu</i>
            </a>
            <span style=" font-size: 1.5rem; margin-left: 4rem!important;">Consulting Doctors </span>
	<a href="Notification.html" class="noti"><i class="material-icons">notifications</i></a>
        </div>
    </nav>
	
	<div class="row" style="overflow: auto; height: 90vh; margin-bottom:0px;">
	<form id="uploadimage" action="" method="post" enctype="multipart/form-data">	
	<div class="col s12 m12"> 
			
			<div class="input-field col s12 m12" style="margin-bottom: 1rem;">
				<input type="button" id="btnSubmit" value="Add Consulting Doctor" class="col s12 m12 btn btn-block" />
			</div>
		
		
		<div class="row">		
			<table  name="myrole" class='table-striped' > 
			<thead>
			<tr>
				<th >Doctor Name</th>
				<th >Mobile No</th>    
			</tr>
			</thead>
			<tbody id="myrole" class="well-lg"></tbody>
			</table>
			
		</div>
		 </div>
	</form></div>
  <img id="loading_img" style="width: 20%;text-align: center;position: absolute;top: 24%;left: 40%;z-index: 1;display:none;" src="images/uploading.gif" >
  </body>
 
  <script type="text/javascript"> 

 $('.brand-logo').sideNav({
            menuWidth: 300, // Default is 300
            edge: 'left', // Choose the horizontal origin
            closeOnClick: true, // Closes side-nav on <a> clicks, useful for Angular/Meteor
            draggable: true, // Choose whether you can drag to open on touch screens,
            onOpen: function (el) { /* Do Stuff */ }, // A function to be called when sideNav is opened
            onClose: function (el) { /* Do Stuff */ }, // A function to be called when sideNav is closed
        });
		
		
	var loginname = localStorage.getItem('user_name');
	var User_id = localStorage.getItem('u_id');
	//alert(User_id);
	  
    $('#loginname').text(loginname);
	
$("#btnSubmit").click(function () {	
var flg=1;
localStorage.setItem('flgup',flg);
		window.location.href="SaveDoctor.html";
        });
	
$(function(){

try{
             $.ajax({
                               
                                type: "POST",
								url: "https://www.manoramahealthcare.com/health_record_organizer/consulting_doctor_list.php",
                                data : 'user_id=' + User_id, 
						 success: function (msg)
                            {
								 var parseJson = JSON.parse(msg);    
									 //alert(parseJson[1].role_name)
								//$("#myrole").append('<tr class="collection-item" style="font-weight:bold;text-align:center;"><td>File Name</td> class="collection-item" style="font-weight:bold;text-align:center"><td>Date</td></tr>');
	
	if(parseJson.result == false){
	
	$("#myrole").append("<span class='norecord'>No Consulting Doctor is Added</span>");
	return false;
	}else {
	for(var i =0;i < parseJson.message.length;i++)
			{
				$("#myrole").append('<tr><td style="" class="docname" doc-id="'+parseJson.message[i].consulting_doctor_id+'" > <span style="text-transform: uppercase;">'+ parseJson.message[i].consulting_doctor_name+'</span></br> Speciality: '+parseJson.message[i].consulting_doctor_specialty+'</td><td class="callno" data-mob="'+parseJson.message[i].consulting_doctor_mobile+'"><span><i class="Small material-icons callr">phone</i></span></td></tr>');
									
			}
			$(".docname").click(function(){
			var flg=0;
			var docid = $(this).attr('doc-id');
			//alert(docid);	
			localStorage.setItem('doc_id',docid);
			localStorage.setItem('flgup',flg);
			window.location.href="SaveDoctor.html";
			
			});
			$(".callno").click(function(){
			var mob = $(this).attr('data-mob');			
			dial(mob);
			});
			}
			},
 			 
					});
                } catch(e){
                	if(e.status == '0'){
                	//	alert("Request failed");
                	
                		$("#image_id").hide();
                	} else if(e.status == '404') {
                	//	alert("Page not found");
                	
                		$("#image_id").hide();
                	} else if(e.status == '500') {
                	//	alert("Internal Server Error.");
                	
                		$("#image_id").hide();
                	}
                	  else {
                		$("#image_id").hide();
                		return; //skip this error
                	}
                }
 	
});

function onSuccess(result){
  console.log("Success:"+result);
}

function onError(result) {
 console.log("Error:"+result);
}
function dial(number){
 //alert(number);
  //console.log("Launching Calling Service for number "+number);
  window.plugins.CallNumber.callNumber(onSuccess, onError, number, false);
}
 
  function onLoad()
     {
        document.addEventListener("backbutton", onBackKeyDown, false);
     }
     
     function onBackKeyDown()
     {
       window.location.href="Menu.html";
    }
	
	function share()
	{ 
	
	   window.plugins.socialsharing.share("Hey check out our new app My HealthDoc", null, null, "https://play.google.com/store/apps/details?id=com.manorama.healthrecordorganizer")
    }
</script>
</html>